/*! HammerHead2 23-05-2014 */
Hammerhead={},function(a){"use strict";function b(a,b){if(isObj(a)){if(a.x)return c(a);if(a.pageX)return d(a);if(a.deltaX)return e(a)}return Object.freeze({x:a||0,y:b||0})}function c(a){return b(a.x,a.y)}function d(a){return b(a.pageX,a.pageY)}function e(a){return b(a.deltaX,a.deltaY)}function f(a){return function(c){return b(a.x+c.x,a.y+c.y)}}function g(a){return function(c){return b(a.x-c.x,a.y-c.y)}}function h(a){return function(c){return c=c||b(),b(c.x-a.x,c.y-a.y)}}function i(a){return function(c){return b(a*c.x,a*c.y)}}function j(a){return function(c){var d=a.x<c.x?a.x:c.x,e=a.y<c.y?a.y:c.y;return b(d,e)}}function k(a){return function(c){var d=a.x>c.x?a.x:c.x,e=a.y>c.y?a.y:c.y;return b(d,e)}}function l(a){return function(c){var d=a.a*c.x+a.c*c.y+a.e,e=a.b*c.x+a.d*c.y+a.f;return b(d,e)}}var m=_.extend({createFromCoordinate:c,createFromPagePoint:d,createFromDisplacementVector:e,add:f,subtract:g,negate:h,scalar:i,min:j,max:k,matrixTransform:l});m(b),a.Point=b}(Hammerhead),function(a){function b(a,b){return"string"==typeof a?c(a):Object.freeze({minimal:a,maximal:b})}function c(a){function c(a){return parseInt(a,10)}var d=a.split(" ").map(c),e=i(d[0],d[1]),f=i(d[2],d[3]),g=i.add(e)(f);return b(e,g)}function d(a){var b=a.minimal.x,c=a.minimal.y,d=a.maximal.x,e=a.maximal.y,f=[b,c,d-b,e-c];return f.join(" ")}function e(a){return i.scalar(.5)(i.add(a.minimal)(a.maximal))}function f(a){return function(b){var c=_.map(i.negate(a));return Object.freeze(c(b))}}function g(a){return function(b){var c=_.map(i.scalar(1/a));return Object.freeze(c(b))}}function h(a){return function(b){return function(c){return b=b||e(c),_.compose(f(i.negate(b)()),g(a),f(b))(c)}}}var i=a.Point,j=_.extend({midpoint:e,translate:f,scale:g,zoom:h,attrString:d});j(b),a.ViewBox=b}(Hammerhead),function(a){function b(b){var c,d,e;d=c=e=a.ViewBox(b.getAttribute("viewBox"));var f=Object.create(prototype);return _.extend({getCurrent:function(){return d},setTemporary:function(a){c=a},fix:function(){d=c},getScreenCTM:function(){return b.getScreenCTM()}})(f),f}var c=a.ViewBox,d=a.Point;prototype={translate:function(a){var b=c.translate(a)(this.getCurrent());return this.setTemporary(b),this},scale:function(a,b){var d=c.zoom(a)(b)(this.getCurrent());return this.setTemporary(d),this},drag:function(a){var b=this.scaleTo()(a);return this.translate(b)},zoom:function(a,b){var c;return b&&(c=this.mapTo()(b)),this.scale(a,c)},mapTo:function(){return d.matrixTransform(this.getScreenCTM().inverse())},scaleTo:function(){return d.matrixTransform(_.merge({e:0,f:0})(this.getScreenCTM().inverse()))}},a.AgileView=b}(Hammerhead),function(a){function b(a,b){function c(){e.off("touch drag pinch release",j)}var d,e=b.hammertime,f=function(b){return"touch"===b.type&&b.target.ownerSVGElement===a?(pubsubz.publish("start",b.gesture),g):void 0},g=function(a){return"drag"===a.type?(pubsubz.publish("drag",a.gesture),h):"pinch"===a.type?(pubsubz.publish("pinch",a.gesture),i):"release"===a.type?(pubsubz.publish("end",a.gesture),f):void 0},h=function(a){if("drag"===a.type)pubsubz.publish("drag",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},i=function(a){if("pinch"===a.type)pubsubz.publish("pinch",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},j=function(a){d=d(a)||d};e.on("touch drag pinch release",j),d=f;var k=Object.create({});return _.extend({kill:c})(k),k}a.Controller=b}(Hammerhead),function(a){function b(a){hammertime=Hammer(document);var b=document.getElementById(a),c=(Hammerhead.Controller(b,{hammertime:hammertime}),Hammerhead.AgileView(b));pubsubz.subscribe("start",function(){console.log("start")}),pubsubz.subscribe("end",function(){c.fix();var a=Hammerhead.ViewBox.attrString(c.getCurrent());b.setAttribute("style",""),b.setAttribute("viewBox",a)}),pubsubz.subscribe("drag",function(a,d){var e=d.deltaX,f=d.deltaY;b.setAttribute("style","-webkit-transform: translate("+e+"px, "+f+"px)"),pt=Hammerhead.Point(d),c.drag(pt)}),pubsubz.subscribe("pinch",function(a,d){b.setAttribute("style","-webkit-transform: scale("+d.scale+")"),c.zoom(d.scale)})}a.Create=b}(Hammerhead);