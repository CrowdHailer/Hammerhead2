/*! HammerHead2 31-05-2014 */
function interpolate(a){var b=0;return function(c){return a.replace(/%(?:\(([^)]+)\))?([%diouxXeEfFgGcrs])/g,function(a,d,e){return"%"==e?"%":c[d||b++]})}}!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),Hammerhead={},function(a){"use strict";function b(a,b){if(isObj(a)){if(a.x)return c(a);if(a.pageX)return d(a);if(a.deltaX)return e(a)}return Object.freeze({x:a||0,y:b||0})}function c(a){return b(a.x,a.y)}function d(a){return b(a.pageX,a.pageY)}function e(a){return b(a.deltaX,a.deltaY)}function f(a){return function(c){return b(a.x+c.x,a.y+c.y)}}function g(a){return function(c){return b(a.x-c.x,a.y-c.y)}}function h(a){return function(c){return c=c||b(),b(c.x-a.x,c.y-a.y)}}function i(a){return function(c){return b(a*c.x,a*c.y)}}function j(a){return function(c){var d=a.x<c.x?a.x:c.x,e=a.y<c.y?a.y:c.y;return b(d,e)}}function k(a){return function(c){var d=a.x>c.x?a.x:c.x,e=a.y>c.y?a.y:c.y;return b(d,e)}}function l(a){return function(c){var d=a.a*c.x+a.c*c.y+a.e,e=a.b*c.x+a.d*c.y+a.f;return b(d,e)}}var m=_.extend({createFromCoordinate:c,createFromPagePoint:d,createFromDisplacementVector:e,add:f,subtract:g,negate:h,scalar:i,min:j,max:k,matrixTransform:l});m(b),a.Point=b}(Hammerhead),function(a){function b(a,b){return"string"==typeof a?c(a):Object.freeze({minimal:a,maximal:b})}function c(a){function c(a){return parseInt(a,10)}var d=a.split(" ").map(c),e=i(d[0],d[1]),f=i(d[2],d[3]),g=i.add(e)(f);return b(e,g)}function d(a){var b=a.minimal.x,c=a.minimal.y,d=a.maximal.x,e=a.maximal.y,f=[b,c,d-b,e-c];return f.join(" ")}function e(a){return i.scalar(.5)(i.add(a.minimal)(a.maximal))}function f(a){return function(b){var c=_.map(i.negate(a));return Object.freeze(c(b))}}function g(a){return function(b){var c=_.map(i.scalar(1/a));return Object.freeze(c(b))}}function h(a){return function(b){return function(c){return b=b||e(c),_.compose(f(i.negate(b)()),g(a),f(b))(c)}}}var i=a.Point,j=_.extend({midpoint:e,translate:f,scale:g,zoom:h,attrString:d});j(b),a.ViewBox=b}(Hammerhead),function(a){function b(b){var c,d,e;d=c=e=a.ViewBox(b.getAttribute("viewBox"));var f=Object.create(prototype);return _.extend({getCurrent:function(){return d},getTemporary:function(){return c},setTemporary:function(a){c=a},fix:function(){d=c},getScreenCTM:function(){return b.getScreenCTM()}})(f),f}var c=a.ViewBox,d=a.Point;prototype={translate:function(a){var b=c.translate(a)(this.getCurrent());return this.setTemporary(b),this},scale:function(a,b){var d=c.zoom(a)(b)(this.getCurrent());return this.setTemporary(d),this},drag:function(a){var b=this.scaleTo()(a);return this.translate(b)},zoom:function(a,b){var c;return b&&(c=this.mapTo()(b)),this.scale(a,c)},mapTo:function(){return d.matrixTransform(this.getScreenCTM().inverse())},scaleTo:function(){return d.matrixTransform(_.foundation(this.getScreenCTM().inverse())({e:0,f:0}))}},a.AgileView=b}(Hammerhead),function(a){var b={},c=-1,d={};d.publish=function(a,c){if(!b[a])return!1;for(var d=b[a],e=d?d.length:0;e--;)d[e].func(a,c);return!0},d.subscribe=function(a,d){b[a]||(b[a]=[]);var e=(++c).toString();return b[a].push({token:e,func:d}),e},d.unsubscribe=function(a){for(var c in b)if(b[c])for(var d=0,e=b[c].length;e>d;d++)if(b[c][d].token===a)return b[c].splice(d,1),a;return!1},getPubSubz=function(){return d},a.pubsubz=getPubSubz()}(this,this.document),function(a){function b(a,b){function c(){e.off("touch drag pinch release",j)}var d,e=b.hammertime,f=function(b){return"touch"===b.type&&b.target.ownerSVGElement===a?(pubsubz.publish("start",b.gesture),g):void 0},g=function(a){return"drag"===a.type?(pubsubz.publish("drag",a.gesture),h):"pinch"===a.type?(pubsubz.publish("pinch",a.gesture),i):"release"===a.type?(pubsubz.publish("end",a.gesture),f):void 0},h=function(a){if(console.log(a.type),"drag"===a.type)pubsubz.publish("drag",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},i=function(a){if("pinch"===a.type)pubsubz.publish("pinch",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},j=function(a){d=d(a)||d};e.on("touch drag pinch release",j),e.on("touch drag pinch release",function(a){console.log("ruddy",a.type)}),d=f;var k=Object.create({});return _.extend({kill:c})(k),k}a.Controller=b}(Hammerhead),function(a){function b(a){return $parent=a.parent(),function(){var b=$parent.height(),c=$parent.width();a.css("margin",-b/2+" "+-c/2),a.width(2*c),a.height(2*b)}}function c(a,c){var f=$("#"+a),g=f[0];console.log("started with options ",c);var h=b(f);Hammerhead.Controller(g,{hammertime:c.hammertime});var i=Hammerhead.AgileView(g);h(),f.css({"-webkit-transform":"translate(0px, 0px)",transform:"translate(0px, 0px)","-webkit-backface-visibility":"hidden","-webkit-transform-origin":"50% 50%","-ms-transform-origin":"50% 50%","transform-origin":"50% 50%"}),d.on("resize",function(a){e(a)}),pubsubz.subscribe("resize",function(){h()}),pubsubz.subscribe("end",function(){i.fix();var a=Hammerhead.ViewBox.attrString(i.getCurrent());f.css("-webkit-transform","translate(0px, 0px)"),f.css("-ms-transform","translate(0px, 0px)"),f.css("transform","translate(0px, 0px)"),f.attr("viewBox",a)}),pubsubz.subscribe("drag",function(a,b){var c=b.deltaX,d=b.deltaY;f.css("-webkit-transform","translate("+c+"px, "+d+"px)"),f.css("-ms-transform","translate("+c+"px, "+d+"px)"),f.css("transform","translate("+c+"px, "+d+"px)"),pt=Hammerhead.Point(b),i.drag(pt)}),pubsubz.subscribe("pinch",function(a,b){f.css("-webkit-transform","scale("+b.scale+")"),f.css("-ms-transform","scale("+b.scale+")"),f.css("transform","scale("+b.scale+")"),i.zoom(b.scale)})}var d=$(window),e=_.debounce(function(){pubsubz.publish("resize")},400);a.Create=c}(Hammerhead);