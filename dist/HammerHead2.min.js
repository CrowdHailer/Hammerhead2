/*! HammerHead2 28-05-2014 */
Hammerhead={},function(a){"use strict";function b(a,b){if(isObj(a)){if(a.x)return c(a);if(a.pageX)return d(a);if(a.deltaX)return e(a)}return Object.freeze({x:a||0,y:b||0})}function c(a){return b(a.x,a.y)}function d(a){return b(a.pageX,a.pageY)}function e(a){return b(a.deltaX,a.deltaY)}function f(a){return function(c){return b(a.x+c.x,a.y+c.y)}}function g(a){return function(c){return b(a.x-c.x,a.y-c.y)}}function h(a){return function(c){return c=c||b(),b(c.x-a.x,c.y-a.y)}}function i(a){return function(c){return b(a*c.x,a*c.y)}}function j(a){return function(c){var d=a.x<c.x?a.x:c.x,e=a.y<c.y?a.y:c.y;return b(d,e)}}function k(a){return function(c){var d=a.x>c.x?a.x:c.x,e=a.y>c.y?a.y:c.y;return b(d,e)}}function l(a){return function(c){var d=a.a*c.x+a.c*c.y+a.e,e=a.b*c.x+a.d*c.y+a.f;return b(d,e)}}var m=_.extend({createFromCoordinate:c,createFromPagePoint:d,createFromDisplacementVector:e,add:f,subtract:g,negate:h,scalar:i,min:j,max:k,matrixTransform:l});m(b),a.Point=b}(Hammerhead),function(a){function b(a,b){return"string"==typeof a?c(a):Object.freeze({minimal:a,maximal:b})}function c(a){function c(a){return parseInt(a,10)}var d=a.split(" ").map(c),e=i(d[0],d[1]),f=i(d[2],d[3]),g=i.add(e)(f);return b(e,g)}function d(a){var b=a.minimal.x,c=a.minimal.y,d=a.maximal.x,e=a.maximal.y,f=[b,c,d-b,e-c];return f.join(" ")}function e(a){return i.scalar(.5)(i.add(a.minimal)(a.maximal))}function f(a){return function(b){var c=_.map(i.negate(a));return Object.freeze(c(b))}}function g(a){return function(b){var c=_.map(i.scalar(1/a));return Object.freeze(c(b))}}function h(a){return function(b){return function(c){return b=b||e(c),_.compose(f(i.negate(b)()),g(a),f(b))(c)}}}var i=a.Point,j=_.extend({midpoint:e,translate:f,scale:g,zoom:h,attrString:d});j(b),a.ViewBox=b}(Hammerhead),function(a){function b(b){var c,d,e;d=c=e=a.ViewBox(b.getAttribute("viewBox"));var f=Object.create(prototype);return _.extend({getCurrent:function(){return d},setTemporary:function(a){c=a},fix:function(){d=c},getScreenCTM:function(){return b.getScreenCTM()}})(f),f}var c=a.ViewBox,d=a.Point;prototype={translate:function(a){var b=c.translate(a)(this.getCurrent());return this.setTemporary(b),this},scale:function(a,b){var d=c.zoom(a)(b)(this.getCurrent());return this.setTemporary(d),this},drag:function(a){var b=this.scaleTo()(a);return this.translate(b)},zoom:function(a,b){var c;return b&&(c=this.mapTo()(b)),this.scale(a,c)},mapTo:function(){return d.matrixTransform(this.getScreenCTM().inverse())},scaleTo:function(){return d.matrixTransform(_.foundation({e:0,f:0})(this.getScreenCTM().inverse()))}},a.AgileView=b}(Hammerhead),function(a){function b(a,b){function c(){e.off("touch drag pinch release",j)}var d,e=b.hammertime,f=function(b){return"touch"===b.type&&b.target.ownerSVGElement===a?(pubsubz.publish("start",b.gesture),g):void 0},g=function(a){return"drag"===a.type?(pubsubz.publish("drag",a.gesture),h):"pinch"===a.type?(pubsubz.publish("pinch",a.gesture),i):"release"===a.type?(pubsubz.publish("end",a.gesture),f):void 0},h=function(a){if("drag"===a.type)pubsubz.publish("drag",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},i=function(a){if("pinch"===a.type)pubsubz.publish("pinch",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},j=function(a){d=d(a)||d};e.on("touch drag pinch release",j),d=f;var k=Object.create({});return _.extend({kill:c})(k),k}a.Controller=b}(Hammerhead),_.now=Date.now||function(){return(new Date).getTime()},_.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=_.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=_.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},function(a){function b(a){return $parent=a.parent(),function(){var b=-$parent.height()/2+" "+-$parent.width()/2;a.css("margin",b),a.width(2*$parent.width()),a.height(2*$parent.height())}}function c(a){var c=$("#"+a),f=b(c);f(),d.on("resize",function(a){e(a)}),pubsubz.subscribe("resize",function(){f()}),hammertime=Hammer(document);var g=document.getElementById(a),h=(Hammerhead.Controller(g,{hammertime:hammertime}),Hammerhead.AgileView(g));pubsubz.subscribe("start",function(){console.log("start")}),pubsubz.subscribe("end",function(){h.fix();var a=Hammerhead.ViewBox.attrString(h.getCurrent());c.css("-webkit-transform","translate(0px, 0px)"),c.attr("viewBox",a)}),pubsubz.subscribe("drag",function(a,b){var d=b.deltaX,e=b.deltaY;c.css("style","-webkit-backface-visibility: hidden; -webkit-transform-origin: 50% 50%; cursor: move; transition: none; -webkit-transition: none; -webkit-transform: translate("+d+"px, "+e+"px)"),pt=Hammerhead.Point(b),h.drag(pt)}),pubsubz.subscribe("pinch",function(a,b){c.css("style","-webkit-transform: scale("+b.scale+")"),h.zoom(b.scale)})}var d=$(window),e=_.debounce(function(){pubsubz.publish("resize")},400);a.Create=c}(Hammerhead);