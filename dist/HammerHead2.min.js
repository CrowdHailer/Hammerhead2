/*! HammerHead2 22-05-2014 */
Hammerhead={},function(a){function b(a,b){return Object.freeze({x:a||0,y:b||0})}function c(a){return function(c){return b(a.x+c.x,a.y+c.y)}}function d(a){return function(c){return b(a.x-c.x,a.y-c.y)}}function e(a){return function(c){return c=c||b(),b(c.x-a.x,c.y-a.y)}}function f(a){return function(c){return b(a*c.x,a*c.y)}}function g(a){return function(c){var d=a.x<c.x?a.x:c.x,e=a.y<c.y?a.y:c.y;return b(d,e)}}function h(a){return function(c){var d=a.x>c.x?a.x:c.x,e=a.y>c.y?a.y:c.y;return b(d,e)}}function i(a){return function(c){var d=a.a*c.x+a.c*c.y+a.e,e=a.b*c.x+a.d*c.y+a.f;return b(d,e)}}var j=_.extend({add:c,subtract:d,negate:e,scalar:f,min:g,max:h,matrixTransform:i});j(b),a.Point=b}(Hammerhead),function(a){function b(a,b){return"string"==typeof a?c(a):Object.freeze({minimal:a,maximal:b})}function c(a){function c(a){return parseInt(a,10)}var d=a.split(" ").map(c),e=i(d[0],d[1]),f=i(d[2],d[3]),g=i.add(e)(f);return b(e,g)}function d(a){var b=a.minimal.x,c=a.minimal.y,d=a.maximal.x,e=a.maximal.y,f=[b,c,d-b,e-c];return f.join(" ")}function e(a){return i.scalar(.5)(i.add(a.minimal)(a.maximal))}function f(a){return function(b){var c=_.map(i.negate(a));return Object.freeze(c(b))}}function g(a){return function(b){var c=_.map(i.scalar(1/a));return Object.freeze(c(b))}}function h(a){return function(b){return function(c){return b=b||e(c),_.compose(f(i.negate(b)()),g(a),f(b))(c)}}}var i=a.Point,j=_.extend({midpoint:e,translate:f,scale:g,zoom:h,attrString:d});j(b),a.ViewBox=b}(Hammerhead),function(a){function b(b){var c,d,e;d=c=e=a.ViewBox(b.getAttribute("viewBox"));var f=Object.create(prototype);return _.extend({getCurrent:function(){return d},setTemporary:function(a){c=a},fix:function(){d=c},getScreenCTM:function(){return b.getScreenCTM()}})(f),f}var c=a.ViewBox,d=a.Point;prototype={translate:function(a){var b=c.translate(a)(this.getCurrent());return this.setTemporary(b),this},scale:function(a,b){var d=c.zoom(a)(b)(this.getCurrent());return this.setTemporary(d),this},drag:function(a){var b=this.scaleTo()(a);return this.translate(b)},zoom:function(a,b){var c=this.mapTo()(b);return this.scale(a,c)},mapTo:function(){return d.matrixTransform(this.getScreenCTM().inverse())},scaleTo:function(){return d.matrixTransform(_.merge({e:0,f:0})(this.getScreenCTM().inverse()))}},a.AgileView=b}(Hammerhead),function(a){function b(a,b){function c(){e.off("touch drag pinch release",j)}var d,e=b.hammertime,f=function(b){return"touch"===b.type&&b.target.ownerSVGElement===a?(pubsubz.publish("start",b.gesture),g):void 0},g=function(a){return"drag"===a.type?(pubsubz.publish("drag",a.gesture),h):"pinch"===a.type?(pubsubz.publish("pinch",a.gesture),i):"release"===a.type?(pubsubz.publish("end",a.gesture),f):void 0},h=function(a){if("drag"===a.type)pubsubz.publish("drag",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},i=function(a){if("pinch"===a.type)pubsubz.publish("pinch",a.gesture);else if("release"===a.type)return pubsubz.publish("end",a.gesture),f},j=function(a){d=d(a)||d};e.on("touch drag pinch release",j),d=f;var k=Object.create({});return _.extend({kill:c})(k),k}a.Controller=b}(Hammerhead);